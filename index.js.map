{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"51059240-278fa1e6f61101335ccd91301\";\nconst PER_PAGE = 15;\n\n\n\n\nexport async function getImagesByQuery(query, page = 1) {\n    try {\n        const {data} = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                page,\n                per_page: PER_PAGE,\n            },\n        });\n\n        return data;\n    \n      \n    } catch(error) {\n            console.error(error);\n            throw error;\n        }\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\"); \nconst loadMore = document.querySelector(\".js-load-more\");\n \nlet gallery1 = new SimpleLightbox('.gallery a', { \n      captions: true,\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n    captionDelay: 250,\n});\n\nexport function createGallery(arr) {\n    \n    const markup = arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class = \"gallery-item\">\n        <a href=\"${largeImageURL}\" class=\"gallery-link\">\n            <img src=\"${webformatURL}\"\n             alt=\"${tags}\"\n              width=\"360\"\n              height = \"200\"\n              loading=\"lazy\" />\n               <div class=\"info\">\n          <p class =\"gallery-text\"> Likes: ${likes}</p>\n          <p class=\"gallery-text\">Views: ${views}</p>\n          <p class=\"gallery-text\">Comments: ${comments}</p>\n          <p class=\"gallery-text\">Downloads:${downloads}</p>\n        </div>\n           </a>\n        </li>\n    `).join(\"\");\n\n\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n    gallery1.refresh();\n}\n\n\nexport function clearGallery() {\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n    loader.classList.remove(\"hidden\");\n    loader.classList.add(\"active\");\n}\n\nexport function hideLoader() {\n    loader.classList.add(\"hidden\");\n    loader.classList.remove(\"active\");\n   \n}\n\nexport function showLoadMoreButton() {\n    loadMore.classList.remove(\"hidden\");\n    loadMore.style.display = \"block\";\n}\n\nexport function hideLoadMoreButton() {\n    loadMore.classList.add(\"hidden\");\n    loadMore.style.display = \"none\";\n}\n\nexport function getGalleryContainer() {\nreturn gallery;\n}\n\n\nexport function getLoadMore() {\nreturn loadMore;\n}","import { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {\n    createGallery,\n    clearGallery,\n    showLoader,\n    hideLoader,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n    getGalleryContainer,\n    getLoadMore,\n} from \"./js/render-functions.js\";\n\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst searchImage = document.querySelector(\".form\");\nconst userRequest = searchImage.querySelector('input[name=\"search-text\"]');\n\nconst loadMore = getLoadMore();\nconst gallery = getGalleryContainer();\n\nlet currentQuery = \"\";\nlet page = 1;\nlet totalHits = 0;\nhideLoadMoreButton();\n \nfunction handleEndOfResults() {\n  hideLoadMoreButton();\n  iziToast.info({\n    icon: \"fa-solid fa-ban\",\n    iconColor: \"#2222\",\n    backgroundColor: \"#EF4040\",\n    message: \"We're sorry, but you've reached the end of search results.\",\n    timeout: 3000,\n    position: \"topRight\",\n  });\n}\n\n\nsearchImage.addEventListener(\"submit\", handlerSubmit);\n\n\nasync function handlerSubmit(event) {\n    event.preventDefault();\n    const query = userRequest.value.trim();\n    \n    if (!query) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Please enter a search term!\",\n            close: false,\n            position: \"topRight\",\n        });\n        return;\n    }\n     if (query !== currentQuery) {\n    currentQuery = query;\n    page = 1;\n    totalHits = 0;\n    clearGallery();\n    hideLoadMoreButton();\n  }\n\n  showLoader();\n\n\n    try {\n        const data = await getImagesByQuery(currentQuery, page);\n\n        if (data.hits.length === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                timeout: 3000,\n                close: false,\n                position: \"topRight\",\n            })\n            hideLoadMoreButton();\n            return;\n        }\n\n        createGallery(data.hits);\n        \n        totalHits = data.totalHits || totalHits;\n        const pagesCount = Math.ceil(totalHits / 15);\n\n        if (page < pagesCount) {\n            showLoadMoreButton();\n        } else {\n            handleEndOfResults();\n        }\n\n    } catch(error) {\n            console.error(error);\n        }\n        finally {\n            hideLoader();\n        };\n}\n\nloadMore.addEventListener(\"click\", async () => {\n    try {\n        showLoader();\n\n        const nextPage = page + 1;\n        const data = await getImagesByQuery(currentQuery, nextPage);\n\n        if (data.hits.length === 0) {\n            handleEndOfResults();\n            return;\n        }\n        createGallery(data.hits);\n        page = nextPage;\n\n        totalHits = data.totalHits || totalHits;\n        const firstCard = gallery.querySelector(\".gallery-item\");\n        if (firstCard) {\n            const { height: cardHeight } = firstCard.getBoundingClientRect();\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: \"smooth\"\n            });\n        }\n        const pagesCount = Math.ceil(totalHits / 15);\n        if (page >= pagesCount) {\n            handleEndOfResults();\n        }\n    } catch (error) {\n        iziToast.error({\n            message: 'Please try again!',\n            timeout: 3000,\n            position: \"topRight\",\n        })\n        console.error(error);\n    } finally {\n        hideLoader();\n    };\n});\n"],"names":["BASE_URL","API_KEY","PER_PAGE","getImagesByQuery","query","page","data","axios","error","gallery","loader","loadMore","gallery1","SimpleLightbox","createGallery","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getGalleryContainer","getLoadMore","searchImage","userRequest","currentQuery","totalHits","handleEndOfResults","iziToast","handlerSubmit","event","pagesCount","nextPage","firstCard","cardHeight"],"mappings":"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"}